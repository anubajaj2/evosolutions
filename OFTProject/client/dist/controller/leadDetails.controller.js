sap.ui.define(["oft/fiori/controller/BaseController","sap/m/MessageToast","sap/ui/core/Fragment"],function(e,t,o){"use strict";return e.extend("oft.fiori.controller.leadDetails",{onInit:function(){var e=this.getOwnerComponent().getRouter();e.attachRouteMatched(this._onRouteMatched,this);jQuery.sap.includeScript({url:"https://www.google.com/recaptcha/api.js"})},_onRouteMatched:function(e){debugger;var t=e.getParameter("name");this.getView().getModel("local").setProperty("/onResendOTP",false);this.getView().getModel("local").setProperty("/otpVisible",false);this.getView().getModel("local").setProperty("/PageVisibility",false);this.getView().getModel("local").setProperty("/verifySubmit",false);if(t==="leadDetails"){this.onOpenDialog()}},onOpenDialog:function(){var e=this.getView();var t=this;if(!this.oDialog){this.oDialog=o.load({id:e.getId(),name:"oft.fiori.fragments.leadDetails",controller:this}).then(function(t){e.addDependent(t);return t}.bind(this));this.oDialog.then(function(e){t.getView().getModel("local").setProperty("/onResendOTP",false);t.getView().getModel("local").setProperty("/otpVisible",false);t.getView().getModel("local").setProperty("/PageVisibility",false);t.getView().getModel("local").setProperty("/verifySubmit",false);e.open()})}},numberValidation:function(e){var t=e.getSource();var o=t.getValue();if(o.length!==10||isNaN(o)){t.setValueState("Error");t.setValueStateText("Please enter a valid 10 digit mobile number")}else{t.setValueState("None");t.setValueStateText("")}},validateCaptcha:function(){var e=this.getView().getModel("local").getProperty("/mobileNumber");if(e==undefined){t.show("Please Enter Mobile Number");return}if(grecaptcha.getResponse().length==0){t.show("Captcha not validated");return}else{this.getView().getModel("local").setProperty("/otpVisible",true);this.getView().getModel("local").setProperty("/sendOtp",false);this.getView().getModel("local").setProperty("/MobileNumber",false);this.OtpSend()}return true},onSubmit:function(){debugger;this.oDialog.then(function(e){e.close()});this.getView().getModel("local").setProperty("/PageVisibility",true)},OtpSend:function(){this.getView().getModel("local").setProperty("/otpVisible",true);var e=this;var t=(new Date).getTime()+1e4;var o=setInterval(function(){var i=(new Date).getTime();var l=t-i;var r=Math.floor(l%(1e3*60*60)/(1e3*60));var a=Math.floor(l%(1e3*60)/1e3);var s="Resend OTP in "+a+"s";e.getView().getModel("local").setProperty("/timerText",s);e.getView().getModel("local").setProperty("/verifySubmit",true);if(l<0){clearInterval(o);e.getView().getModel("local").setProperty("/timerText","Resend");e.getView().getModel("local").setProperty("/onResendOTP",true);e.getView().getModel("local").setProperty("/ResendMsg","If OTP not Received ")}},1e3)}})});
//# sourceMappingURL=leadDetails.controller.js.map